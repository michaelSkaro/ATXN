---
title: "6/2 Functions"
author: "Skylar A. Gay"
date: "6/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
All of the packages needed to complete the below functions.
```{r}

library(dplyr)
library(ggplot2)
library(corrplot)
library(cluster) 
library(fpc)
library(devtools)
library(ggpubr)
library(C50)
```
Loading the library database and setting the data frame = the iris data set
```{r}
library(datasets) #this would be removed when dataset is available
dataframe <- iris #"iris" would be replaced with the file.choose(*datafilename*)
```
Each function used to interpret the iris data set.
```{r}
summaryinfo <- function(dataframe){ #shows summary for data including str(prints all data to the console, dim(prints the number of rows and columns), and summary (shows statistical information about the data in that item).
  str(dataframe)
  dim(dataframe)
  summary(dataframe) 
}
pairsplots <- function(dataframe){ #creates a colored plot matrix of scatterplots
  pairs <- pairs(dataframe[,1:4],col=dataframe[,5],oma=c(4,4,6,12))
  par(xpd=TRUE)
  legend(0.85,0.6, as.vector(unique(dataframe$Species)),fill=c(1,2,3))
}
boxplots <- function(dataframe){ #creates a boxplot of all provided data broken down by column name
  par(mar=c(7,5,1,1))
  boxplot(dataframe)#
}
boxplotspec <- function(dataframe){ #creates a boxplot for each species
  dfsub1 <- subset(dataframe, Species == "versicolor")
  dfsub2 <- subset(dataframe, Species == "setosa")
  dfsub3 <- subset(dataframe, Species == "virginica")
  par(mfrow=c(1,3),mar=c(6,3,2,1))
  boxplot(dfsub1[,1:4], main="Versicolor",ylim = c(0,8),las=2)
  boxplot(dfsub2[,1:4], main="Setosa",ylim = c(0,8),las=2)
  boxplot(dfsub3[,1:4], main="Virginica",ylim = c(0,8),las=2)
}
histplot <- function(dataframe){ #creates a histogram of all species using the data provided
  hist(dataframe$Petal.Length)#to change the data in the plots, replace "Petal.Length" with the desired data column name
  par(mfrow=c(1,3))
}
histplotsspec <- function(dataframe){ #creates histograms of each species.
  dfsub1 <- subset(dataframe, Species == "versicolor")
  dfsub2 <- subset(dataframe, Species == "setosa")
  dfsub3 <- subset(dataframe, Species == "virginica")
  hist1 <- hist(dfsub1$Petal.Length,breaks=seq(0,8,l=17),xlim=c(0,8),ylim=c(0,40))
  hist2 <- hist(dfsub2$Petal.Length,breaks=seq(0,8,l=17),xlim=c(0,8),ylim=c(0,40))
  hist3 <- hist(dfsub3$Petal.Length,breaks=seq(0,8,l=17),xlim=c(0,8),ylim=c(0,40))
  #to change the data in the plots, replace "Petal.Length" with the desired data column name
}
treeunprun <- function(dataframe){ #creates an unpruned decision tree from the data
  input <- dataframe[,1:4]
  output <- dataframe[,5]
  model1 <- C5.0(input, output, control = C5.0Control(noGlobalPruning = TRUE,minCases=1))
  plot(model1)
}
treeprun <- function(dataframe){ #creates a pruned decision tree from the data
  input <- dataframe[,1:4]
  output <- dataframe[,5]
  model2 <- C5.0(input, output, control = C5.0Control(noGlobalPruning = FALSE))
  plot(model2, main="C5.0 Decision Tree - Pruned")
}
parcoord <- function(dataframe){ #creates a parallel coordinates chart of data
  parcoord(dataframe[,1:4], col=dataframe[,5],var.label=TRUE,oma=c(4,4,6,12))
  par(xpd=TRUE)
  legend(0.85,0.6, as.vector(unique(dataframe$Species)),fill=c(1,2,3))
  
}
corr <- function(dataframe){ #correlation function to determine which of the pairs have posetive or negative correlations.
  corr <- cor(dataframe[,1:4])
  round(corr,3) 
  #posetive 1 = correlated
  #negative 1 = inverse correlation
}
beanplot <- function(dataframe){ #creates a beanplot which shows the density curve not present in a boxplots
  xiris <- dataframe
  xiris$Species <- NULL
  beanplot(xiris,col=c('#ff8080','#0000FF','#0000FF','#FF00FF'), border = "#000000")
  #name the plot by adding "main = *plot name*
}
clustplot <- function(dataframe){
  set.seed(8593)
  dataframe$Species <- NULL
  (kmeans.result <- kmeans(dataframe, 3))
  table(iris$Species, kmeans.result$cluster)#I tried using the dataframe in this line (dataframe$species) but my out put was an error saying that my arguments needed to be all one length. Any suggestions?
  plot(dataframe[c("Sepal.Length", "Sepal.Width")], col = kmeans.result$cluster)
  points(kmeans.result$centers[c("Sepal.Length", "Sepal.Width")], col = 1:3, pch = 8, cex= 2)
  data_for_clustering <- dataframe[,-5] 
  clusters_dataframe <- kmeans(data_for_clustering, centers = 3) 
  plotcluster(data_for_clustering,clusters_dataframe$cluster) 
  clusplot(data_for_clustering, clusters_dataframe$cluster, color = TRUE, shade = TRUE)
}
#I am still working on arranging these using ggpubr. When I try to use the gg*plotname* command, it says that I am supplying too many data points.
